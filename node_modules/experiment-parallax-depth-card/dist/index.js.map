{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import * as React from 'react'\nimport styles from './styles.module.css'\n\ntype ParallaxDepthCardPropsType = {\n  backgroundUrl: string\n  title: string\n  children?: React.ReactChild\n  onClick?: Function\n}\n\ntype ParallaxDepthCardStateType = {\n  width: number\n  height: number\n  mouseX: number\n  mouseY: number\n  mounted: boolean\n}\n\nexport const ParallaxDepthCard: React.FC<ParallaxDepthCardPropsType> = ({\n  backgroundUrl,\n  title,\n  onClick,\n  children\n}: ParallaxDepthCardPropsType) => {\n  const cardWrapRef = React.useRef<HTMLDivElement>(null)\n\n  const [state, setState] = React.useState<ParallaxDepthCardStateType>({\n    width: 0,\n    height: 0,\n    mouseX: 0,\n    mouseY: 0,\n    mounted: false\n  })\n\n  let mouseLeaveDelay: NodeJS.Timeout | null = null\n\n  const handleMouseMove = (event: React.MouseEvent) => {\n    if (cardWrapRef.current) {\n      const { width, height } = state\n      const newState = {\n        ...state,\n        mouseX: event.pageX - cardWrapRef.current.offsetLeft - width / 2,\n        mouseY: event.pageY - cardWrapRef.current.offsetTop - height / 2\n      }\n\n      setState(newState)\n    }\n  }\n\n  const handleMouseEnter = React.useCallback(() => {\n    if (mouseLeaveDelay) {\n      clearTimeout(mouseLeaveDelay)\n    }\n  }, [mouseLeaveDelay])\n\n  const handleMouseLeave = React.useCallback(() => {\n    mouseLeaveDelay = setTimeout(() => {\n      setState({ ...state, mouseX: 0, mouseY: 0 })\n    }, 1000)\n  }, [mouseLeaveDelay, state])\n\n  React.useEffect(() => {\n    const { mounted } = state\n\n    // mimic react.didMount()\n    if (\n      !mounted &&\n      cardWrapRef?.current &&\n      state.width === 0 &&\n      state.height === 0\n    ) {\n      setState({\n        ...state,\n        width: cardWrapRef.current.offsetWidth,\n        height: cardWrapRef.current.offsetHeight,\n        mounted: true\n      })\n    }\n  })\n\n  // computed props\n  const mousePX = () => state.mouseX / state.width\n  const mousePY = () => state.mouseY / state.height\n\n  const cardStyle = () => {\n    const rX = mousePX() * 30\n    const rY = mousePY() * -30\n    return {\n      transform: `rotateY(${rX}deg) rotateX(${rY}deg)`\n    }\n  }\n  const cardBgTransform = () => {\n    const tX = mousePX() * -40\n    const tY = mousePY() * -40\n    return {\n      transform: `translateX(${tX}px) translateY(${tY}px)`\n    }\n  }\n\n  return (\n    <div\n      className={styles['card-container']}\n      onClick={() => onClick && onClick()}\n    >\n      <div\n        className={styles['card-wrap']}\n        onMouseMove={(event) => handleMouseMove(event)}\n        onMouseEnter={handleMouseEnter}\n        onMouseLeave={handleMouseLeave}\n        ref={cardWrapRef}\n      >\n        <div className={styles.card} style={cardStyle()}>\n          <div\n            className={styles['card-bg']}\n            style={{\n              ...cardBgTransform(),\n              backgroundImage: `url(${backgroundUrl})`\n            }}\n          />\n          <div className={styles['card-info']}>\n            <h1>{title}</h1>\n            {children}\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":["ParallaxDepthCard","backgroundUrl","title","onClick","children","cardWrapRef","React","width","height","mouseX","mouseY","mounted","state","setState","mouseLeaveDelay","handleMouseMove","event","current","newState","pageX","offsetLeft","pageY","offsetTop","handleMouseEnter","clearTimeout","handleMouseLeave","setTimeout","offsetWidth","offsetHeight","mousePX","mousePY","cardStyle","rX","rY","transform","cardBgTransform","tX","tY","className","styles","onMouseMove","onMouseEnter","onMouseLeave","ref","card","style","backgroundImage"],"mappings":"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"}